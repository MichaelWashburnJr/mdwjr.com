{% extends 'base.html' %}

{% block title %}{{title}}{% endblock title %}

{% block description %}
    {{description}}
{% endblock description %}

{% block content %}

<div class="container">

    {% if request.user.is_staff %}
    <div class="btn-toolbar pull-right">
        <div class="btn-group">
            <a class="btn btn-small btn-info" href="{% url 'blog:edit_tags' %}">
                <span class="glyphicon glyphicon-edit" ></span> Edit Tags
            </a>
        </div>
        <div class="btn-group">
            <a class="btn btn-small btn-success" href="{% url 'blog:create_post' %}">
                <span class="glyphicon glyphicon-plus" ></span> Add Post
            </a>
        </div>
    </div>
    {% endif %}

    <div class="row">
        <div class="btn-group" role="group">
            <button class="btn btn-primary is-checked filter" data-filter="*">All</button>
            {% for tag in tags %}
            <button class="btn btn-primary is-checked filter" data-filter=".{{tag.slug}}">{{tag}}</button>
            {% endfor %}
        </div>
    </div>
    <div class="row" id="container">
        {% for post in posts %}
        <a class="btn btn-default btn-tile item {{post.tags_to_str}}"
            href="{% url 'blog:post' post.slug %}" class="">
            <h1>
                {{post.title}}
                <br/>
                <small>{{post.posted}}</small>
            </h1>
            
            <div class="tags">
            {% for tag in post.tags.all %}
                {% if tag in tags %}
                <span class="filter tag label label-primary label-md label-border" data-filter=".{{tag.slug}}">{{tag}}</span>
                {% endif %}
            {% endfor %}
            </div>

            
        </a>
        {% endfor %}
    </div>
</div>

{% endblock content %}

{% block scripts %}
<script src="/rsc/js/isotope.pkgd.min.js"></script>
<script type="text/javascript">
    var $container = $('#container');
    // init
    // filter items on button click
    var $start_filter = window.location.hash;
    if($start_filter === "")
    {
        $start_filter = "*";
    }
    else
    {
        $start_filter = ".".concat($start_filter.substring(1));
    }
    $container.isotope({ filter: $start_filter });
    $('body').on( 'click', '.filter', function(e) {
        e.preventDefault();
        var filterValue = $(this).attr('data-filter');
        $container.isotope({ filter: filterValue });
    });
    
</script>
{% endblock scripts %}